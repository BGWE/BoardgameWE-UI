language: node_js

node_js:
- '12'

install:
- cd boardgame-ui
- yarn install
- yarn global add firebase-tools

script:
- yarn run build

env:
- CI=false

before_deploy:
- cd ..
- pwd && ls -al . && ls -al boardgame-ui

deploy:
- provider: s3
  access_key_id: AKIAZ44C3UA6WUKB4RYY
  secret_access_key:
    secure: ebtFnxnMF2dkIzKAcQys6FR05bK4HGU0ES4VZ3LQaAXIhig/aj7uIVFfzjNJgjD0fBxfnVdSrLrwplaBJyuhBYTUfDyAROF0L+0VCvYifq/9k/YKyLMl5fgFLtiWLrV/bmZixsiW8YD/JTZBYwELV6bcoExQUx0/z2zYoLoruCHHXiBSG8LGIodlRu5ROekXkwRJf/RTQQWs3JFAWiS8QWkXkZHOr6jP6ehMmil9QuZgiriCy48PQQO1t4dUMGC6tQngJF2Dvi2wJAjoASAjx0e85b6cmvrHypQqt6Da5LW13AXjLGcFfgvJaM6y58tPUXNBcYBDK0FJJGAF7KAAdVzIEFXjntBH54Fxwqmww1EOVom7I9wTkgdADmPTS5VJs0UJC5lEqHC/LknPc10oYh2KwMc7u6tMepnQ+OrfPNv72KP6QcWcw/y0QE9tgNiF9tZ0kbcZkr/4nrmV9t1Qq1CXG6n61syKpA/b052QoeDBgi8Fn/bgypVBcUTaUowDD6NU7rdywv0ad7jLipcsUTiP0zIB/34TWdsDSSo/30nIozI4oosM2nLtb83QE1Z+mHtLHME07lxlgsOQ+/57C34NjvVzKS1/EX8Iethpn7i8W4Ryk4QnQdzrAKhudj4c/oPFOHQ75JfZpD0VRSkTPobCN+uMt6GW1RLlczMD19Y=
  bucket: www.boardgamecomponion.com
  acl: public_read
  region: eu-west-1
  skip_cleanup: true
  local_dir: boardgame-ui/dist
  on:
    branch: master
  
- provider: s3
  access_key_id: AKIAZ44C3UA6WUKB4RYY
  secret_access_key:
    secure: ebtFnxnMF2dkIzKAcQys6FR05bK4HGU0ES4VZ3LQaAXIhig/aj7uIVFfzjNJgjD0fBxfnVdSrLrwplaBJyuhBYTUfDyAROF0L+0VCvYifq/9k/YKyLMl5fgFLtiWLrV/bmZixsiW8YD/JTZBYwELV6bcoExQUx0/z2zYoLoruCHHXiBSG8LGIodlRu5ROekXkwRJf/RTQQWs3JFAWiS8QWkXkZHOr6jP6ehMmil9QuZgiriCy48PQQO1t4dUMGC6tQngJF2Dvi2wJAjoASAjx0e85b6cmvrHypQqt6Da5LW13AXjLGcFfgvJaM6y58tPUXNBcYBDK0FJJGAF7KAAdVzIEFXjntBH54Fxwqmww1EOVom7I9wTkgdADmPTS5VJs0UJC5lEqHC/LknPc10oYh2KwMc7u6tMepnQ+OrfPNv72KP6QcWcw/y0QE9tgNiF9tZ0kbcZkr/4nrmV9t1Qq1CXG6n61syKpA/b052QoeDBgi8Fn/bgypVBcUTaUowDD6NU7rdywv0ad7jLipcsUTiP0zIB/34TWdsDSSo/30nIozI4oosM2nLtb83QE1Z+mHtLHME07lxlgsOQ+/57C34NjvVzKS1/EX8Iethpn7i8W4Ryk4QnQdzrAKhudj4c/oPFOHQ75JfZpD0VRSkTPobCN+uMt6GW1RLlczMD19Y=
  bucket: stg.boardgamecomponion.com
  acl: public_read
  region: eu-west-1
  skip_cleanup: true
  local_dir: boardgame-ui/dist
  on:
    branch: develop